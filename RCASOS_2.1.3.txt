2.1 

--- CASO 1

SELECT 

   CARRERAID AS "IDENTIFICACION DE LA CARRERA",COUNT(ALUMNOID) AS "TOTAL ALUMNOS MATRICULADOS",

   'Le corresponden'||TO_CHAR(TRIM(COUNT(ALUMNOID)*30200),'L999G999')||

   ' del presupuesto total asignado para publicidad' AS "MONTO POR PUBLICIDAD"

   FROM ALUMNO

   GROUP BY CARRERAID

   ORDER BY COUNT(ALUMNOID) DESC, CARRERAID;



--- CASO 2

SELECT 

   CARRERAID AS "CARRERA",

   COUNT(ALUMNOID) AS "TOTAL DE ALUMNOS"

   FROM ALUMNO

   GROUP BY CARRERAID

   HAVING COUNT(ALUMNOID) >4

   ORDER BY CARRERAID;

   

--- CASO 3

SELECT 

   TO_CHAR(RUN_JEFE,'99G999G999') AS "RUN JEFE SIN DV",

   COUNT(RUN_JEFE) AS "TOTAL DE EMPLEADOS A SU CARGO",

   TO_CHAR (MAX(SALARIO),'999G999G999') AS "SALARIO MAXIMO",

   TO_CHAR(COUNT(RUN_JEFE)*10) || '% del salario maximo' AS "PORCENTAJE DE BONIFICACION",

   TO_CHAR((MAX(SALARIO)/100)*(COUNT(RUN_JEFE)*10),'L999G999G999') AS "BONIFICACION"

   FROM EMPLEADO

   WHERE RUN_JEFE IS NOT NULL

   GROUP BY RUN_JEFE

   ORDER BY COUNT(RUN_JEFE);



--- CASO 4

SELECT 

   EM.ID_ESCOLARIDAD AS "ESCOLARIDAD",

   EM.DESC_ESCOLARIDAD AS "DESCRIPCION ESCOLARIDAD",

   COUNT(RUN_EMP) AS "TOTAL EMPLEADOS",

   TO_CHAR(MAX(SALARIO),'L999G999G999') AS "SALARIO MAXIMO",

   TO_CHAR(MIN(SALARIO),'L999G999G999') AS "SALARIO MINIMO",

   TO_CHAR(SUM(SALARIO),'L999G999G999') AS "SALARIO TOTAL",

   TO_CHAR(AVG(SALARIO),'L999G999G999') AS "SALARIO PROMEDIO"

   FROM EMPLEADO E

   INNER JOIN ESCOLARIDAD_EMP EM ON E.ID_ESCOLARIDAD = EM.ID_ESCOLARIDAD

   GROUP BY EM.ID_ESCOLARIDAD, EM.DESC_ESCOLARIDAD

   ORDER BY COUNT(RUN_EMP) DESC;

   

--- CASO 5

SELECT

   TITULOID AS "CODIGO DEL LIBRO",

   COUNT(FECHA_TER_PRESTAMO) AS "TOTAL VECES SOLICITADO",

   CASE

       WHEN COUNT(FECHA_TER_PRESTAMO) = 1 THEN 'No se requieren comprar nuevos ejemplares'

       WHEN COUNT(FECHA_TER_PRESTAMO) = 2 OR COUNT(FECHA_TER_PRESTAMO) = 3 THEN 'Se requiere comprar 1 nuevos ejemplares'

       WHEN COUNT(FECHA_TER_PRESTAMO) = 4 OR COUNT(FECHA_TER_PRESTAMO) = 5 THEN 'Se requiere comprar 2 nuevos ejemplares'

       WHEN COUNT(FECHA_TER_PRESTAMO) >5 THEN 'Se requiere comprar 4 nuevos ejemplares'

       END AS "SUGERENCIA"

   FROM PRESTAMO

   WHERE TO_CHAR(ADD_MONTHS(FECHA_TER_PRESTAMO, -12), 'YYYY') = TO_CHAR(ADD_MONTHS(FECHA_TER_PRESTAMO, -12), 'YYYY')

   GROUP BY TITULOID

   ORDER BY COUNT(FECHA_TER_PRESTAMO) DESC;

   

--- CASO 6

SELECT 

   TO_CHAR(RUN_EMP,'99G999G999') AS "RUN EMPLEADO",

   TO_CHAR(FECHA_INI_PRESTAMO,'MM' ||'/'|| 'YYYY') AS "MES PRESTAMO LIBROS",

   COUNT(FECHA_INI_PRESTAMO) AS "TOTAL PRESTAMOS ATENDIDOS",

   TO_CHAR(COUNT(FECHA_INI_PRESTAMO)*10000,'L999G999G999') AS "ASIGNACION"

   FROM PRESTAMO

   WHERE TO_CHAR(FECHA_INI_PRESTAMO,'YYYY')= &ANIO-1

   GROUP BY RUN_EMP,TO_CHAR(FECHA_INI_PRESTAMO,'MM/YYYY')

   HAVING COUNT(FECHA_INI_PRESTAMO)>2

   ORDER BY TO_CHAR(FECHA_INI_PRESTAMO,'MM' ||'/'|| 'YYYY'),"ASIGNACION" DESC, RUN_EMP DESC;